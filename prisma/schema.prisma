generator client {
  provider     = "prisma-client"
  output       = "../src/generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  Admin
  Recruiter
  Jobseeker
}

model User {
  id       Int    @id @default(autoincrement())
  email    String @unique
  password String
  fullname String
  username String
  role     Role   @default(Jobseeker)
  age      Int

  // One-to-many: recruiter -> jobs
  postedJobs Job[] @relation("RecruiterJobs")

  // One-to-many: user -> applications
  applications Application[] @relation("UserApplications")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Job {
  id          Int    @id @default(autoincrement())
  title       String
  description String
  location    String
  salaryRange String

  // Recruiter relation
  userId Int
  user   User @relation("RecruiterJobs", fields: [userId], references: [id], onDelete: Cascade)

  // Applicants relation
  applications Application[] @relation("JobApplications")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Application {
  id Int @id @default(autoincrement())

  userId Int
  user   User @relation("UserApplications", fields: [userId], references: [id], onDelete: Cascade)

  jobId Int
  job   Job @relation("JobApplications", fields: [jobId], references: [id], onDelete: Cascade)

  status     String  @default("applied")
  resumeLink String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
